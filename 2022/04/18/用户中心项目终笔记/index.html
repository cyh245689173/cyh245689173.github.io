<!DOCTYPE html><html lang="zh-CN"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="theme-color" content="#0078E7"><meta name="author" content="丸了鸭"><meta name="copyright" content="丸了鸭"><meta name="generator" content="Hexo 6.2.0"><meta name="theme" content="hexo-theme-yun"><title>用户中心项目终笔记 | 丸了鸭的博客</title><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Noto+Serif+SC:wght@900&amp;display=swap" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://fastly.jsdelivr.net/npm/star-markdown-css@0.3.3/dist/yun/yun-markdown.min.css"><link rel="stylesheet" href="https://fastly.jsdelivr.net/npm/prism-theme-vars/base.css"><script src="https://fastly.jsdelivr.net/npm/scrollreveal/dist/scrollreveal.min.js" defer></script><script>function initScrollReveal() {
  [".post-card",".markdown-body img"].forEach((target)=> {
    ScrollReveal().reveal(target);
  })
}
document.addEventListener("DOMContentLoaded", initScrollReveal);
document.addEventListener("pjax:success", initScrollReveal);
</script><link rel="icon" type="image/png" href="/images/32x32.ico"><link rel="mask-icon" href="/images/32x32.ico" color="#0078E7"><link rel="preload" href="/css/hexo-theme-yun.css" as="style"><link rel="prefetch" href="/js/sidebar.js" as="script"><link rel="preconnect" href="https://cdn.jsdelivr.net" crossorigin><link rel="preconnect" href="https://fastly.jsdelivr.net/npm/" crossorigin><script id="yun-config">
    window.Yun = {}
    window.CONFIG = {"hostname":"cyh245689173.github.io","root":"/","title":"丸了鸭的博客","version":"1.10.4","mode":"auto","copycode":true,"page":{"isPost":true},"i18n":{"placeholder":"想要搜些什么？","empty":"找不到您查询的内容: ${query}","hits":"找到 ${hits} 条结果","hits_time":"找到 ${hits} 条结果（用时 ${time} 毫秒）"},"anonymous_image":"https://cdn.yunyoujun.cn/img/avatar/none.jpg","say":{"api":"https://v1.hitokoto.cn","hitokoto":true},"local_search":{"path":"/search.xml"},"localsearch":{"enable":"auto","trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"fireworks":{"colors":["32, 242, 242"]},"vendors":{"darken":"https://fastly.jsdelivr.net/npm/darken@1.5.0"}};
  </script><link rel="stylesheet" href="/css/hexo-theme-yun.css"><script src="/js/hexo-theme-yun.js" type="module"></script><meta name="description" content="1.完成注册功能的前端开发我发现我的user目录下已经有一个register文件夹了  运行效果是酱婶的  改起来忒麻烦，直接删掉，按照鱼皮的来。  首先将登录部分代码复制一份名称改为Register也放在user目录下，然后打开Register中的index.tsx文件进行改造，将以下两处的Login替换为Register。   然后打开config目录下的routes.ts文件进行路由的添加">
<meta property="og:type" content="article">
<meta property="og:title" content="用户中心项目终笔记">
<meta property="og:url" content="https://cyh245689173.github.io/2022/04/18/%E7%94%A8%E6%88%B7%E4%B8%AD%E5%BF%83%E9%A1%B9%E7%9B%AE%E7%BB%88%E7%AC%94%E8%AE%B0/index.html">
<meta property="og:site_name" content="丸了鸭的博客">
<meta property="og:description" content="1.完成注册功能的前端开发我发现我的user目录下已经有一个register文件夹了  运行效果是酱婶的  改起来忒麻烦，直接删掉，按照鱼皮的来。  首先将登录部分代码复制一份名称改为Register也放在user目录下，然后打开Register中的index.tsx文件进行改造，将以下两处的Login替换为Register。   然后打开config目录下的routes.ts文件进行路由的添加">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/9286/1657889912918-ff4c5ad0-c9d2-4447-ab31-2fca2a1d72c3.png">
<meta property="og:image" content="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/9286/1657889874523-e08d0c36-e0ee-4447-8f2f-59cb8f3b0357.png">
<meta property="og:image" content="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/9286/1657890681042-bbab1d0e-f49e-4799-96df-560a20e9d2ce.png">
<meta property="og:image" content="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/9286/1657890729270-68af2349-2ec4-4376-90ee-12ca17972efc.png">
<meta property="og:image" content="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/9286/1657886603994-a58bdfd2-8e5d-4bad-b9c6-7c486e542161.png">
<meta property="og:image" content="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/9286/1657886630202-18447bf5-1cdc-4a7e-902d-5ce1c339199c.png">
<meta property="og:image" content="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/9286/1657889722720-6b75a992-fc77-4ebb-b28b-7abfe49053d7.png">
<meta property="og:image" content="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/9286/1657889762246-892af0e4-e4aa-4d2b-8555-2b79e578bea0.png">
<meta property="og:image" content="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/9286/1657891058842-e7c327f3-9f63-4fcf-a153-a98f16e2a416.png">
<meta property="og:image" content="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/9286/1657929006411-f2d6353c-32c5-46b8-8dbd-f0484a200e41.png">
<meta property="og:image" content="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/9286/1657929097952-5c1e1094-391d-4bd0-abfb-8ae5ba9a42a4.png">
<meta property="og:image" content="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/9286/1657929256859-303f9c33-c18d-45f1-b0c7-f21770bbbe50.png">
<meta property="og:image" content="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/9286/1657929486713-9b5ae9ef-7d4d-4fc9-bf38-14947d33bd64.png">
<meta property="og:image" content="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/9286/1657929853874-aa94116e-c7d7-4486-bfcd-b00f9a6fae44.png">
<meta property="og:image" content="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/9286/1657929884818-7809af12-a405-4a23-9e54-0383180fffcb.png">
<meta property="og:image" content="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/9286/1657930251178-71d82e55-fe01-4d4f-a6cc-dbd0296ff933.png">
<meta property="og:image" content="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/9286/1657930575638-3c4f8fa0-d81a-4afc-a378-7a8d24f8715b.png">
<meta property="og:image" content="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/9286/1657930768149-178e9770-4346-4891-a7e9-029c3b3443a1.png">
<meta property="og:image" content="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/9286/1657930951224-e4067efa-5b52-4354-99fb-03011a636e66.png">
<meta property="og:image" content="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/9286/1657931058002-a99d87e6-5e03-4174-843b-bc3bcbcdca8d.png">
<meta property="og:image" content="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/9286/1657933347356-9479626c-df34-4eee-b003-3e034627ddb5.png">
<meta property="og:image" content="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/9286/1657933456731-6b53881b-1a22-44f3-9184-9429f216920b.png">
<meta property="og:image" content="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/9286/1657933619411-0c6fde57-fd85-4016-953c-a5c9296efdcf.png">
<meta property="og:image" content="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/9286/1657933850640-705afb35-bb0b-4e03-a738-52a3d28eb478.png">
<meta property="og:image" content="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/9286/1657933971492-4cfa9844-b359-41be-a5ce-68dd06f06f2a.png">
<meta property="og:image" content="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/9286/1657934241825-0e4093f9-3170-42f1-9c95-c6feeaa8a79b.png">
<meta property="og:image" content="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/9286/1657934451859-e338a271-f53b-4717-a8b2-cb8fda1a7b81.png">
<meta property="og:image" content="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/9286/1657934501593-4fefc3d4-a3f8-4bd4-98d9-5d22f3dd851c.png">
<meta property="og:image" content="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/9286/1657934567130-989ef4e8-3a80-4363-b232-7a0262bd951d.png">
<meta property="og:image" content="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/9286/1657935046287-c1750885-e277-4f93-ae95-ef6a46bef8ff.png">
<meta property="og:image" content="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/9286/1657935134377-89b7a49b-814b-4201-8377-f1d96bf04d8c.png">
<meta property="og:image" content="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/9286/1657935540467-94a513cd-24f6-45ff-b1b8-5238169f64f9.png">
<meta property="og:image" content="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/9286/1657935640340-199c5991-a979-405e-865c-1d4e00c1df99.png">
<meta property="og:image" content="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/9286/1657935690773-60e193f1-95b1-47cf-9bd2-c127ef763c32.png">
<meta property="og:image" content="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/9286/1657935724306-73def634-64a9-4ea4-913d-5312cb0c8d1f.png">
<meta property="og:image" content="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/9286/1657935882619-03653bdb-1ee7-4d16-b0f9-cfdd0a41d81e.png">
<meta property="og:image" content="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/9286/1657935956380-586c0e60-4637-4d4f-a054-de8a1aca5591.png">
<meta property="og:image" content="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/9286/1657936056309-ac2061ff-9a27-47cb-ad6e-597a45623021.png">
<meta property="og:image" content="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/9286/1657936101044-e3d228b1-13e1-4e11-853b-4141f6ef993f.png">
<meta property="og:image" content="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/9286/1657936278820-48beea7e-034e-4ce6-8a15-5c20bbd22fe4.png">
<meta property="og:image" content="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/9286/1657937026330-3043d74e-9539-416a-910f-047dd2a201ba.png">
<meta property="og:image" content="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/9286/1657936752623-31c12494-f262-4a2d-a7a7-41f0b6da269b.png">
<meta property="og:image" content="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/9286/1657936806426-9304ee27-a66c-4b3b-9d37-8e7dcb6770b8.png">
<meta property="og:image" content="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/9286/1657940599623-67a23b98-5c61-4855-94dc-e5b7fa1c7ab5.png">
<meta property="og:image" content="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/9286/1657940560990-6aec8bd7-13b0-4540-8cd9-4d9cda2a4a85.png">
<meta property="og:image" content="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/9286/1657940737884-3a21f74f-0ed8-4237-8326-6ef1f3522a83.png">
<meta property="og:image" content="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/9286/1657941126110-998b9e7e-b2df-406a-80df-ddfd19ebfae0.png">
<meta property="og:image" content="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/9286/1657941195656-f908bdbe-4993-4547-b42d-7b99517f73e5.png">
<meta property="og:image" content="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/9286/1657941328796-ac025b6f-4af4-4523-ae00-a051e8d740b3.png">
<meta property="og:image" content="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/9286/1657941454484-8dd5fe1a-8ded-4cdc-b9eb-85d141d76a0c.png">
<meta property="og:image" content="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/9286/1657957540828-5b9335fe-4942-41cd-ac4a-d0684588dd5b.png">
<meta property="og:image" content="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/9286/1657942006481-7f7bae16-53d1-4114-98c9-d39dd89b33af.png">
<meta property="og:image" content="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/9286/1657942106821-a030e95b-2557-4d2a-8103-ec5a93046190.png">
<meta property="og:image" content="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/9286/1657954970730-966238c6-43c1-4038-a3ee-d306a50c0883.png">
<meta property="og:image" content="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/9286/1657955151666-e0db2a4c-9879-472e-8c6e-8ebe33a3e8c0.png">
<meta property="og:image" content="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/9286/1657955242734-d14f3065-8180-45a1-bce9-a1760bd67dfb.png">
<meta property="og:image" content="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/9286/1657955639052-71058bd1-0c4b-4497-8c49-d4d7765a6c23.png">
<meta property="og:image" content="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/9286/1657955744429-ad40417d-64eb-403b-9e26-0842455b85cb.png">
<meta property="og:image" content="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/9286/1657955903243-bb8a5006-edc9-4ddc-aec8-9bfe51a38e70.png">
<meta property="og:image" content="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/9286/1657955939321-e59aa4e2-822b-4726-96fb-e4ef4e96fc2e.png">
<meta property="og:image" content="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/9286/1657956061895-a76ee92b-727a-4a7e-aaef-1b6cb1102bae.png">
<meta property="og:image" content="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/9286/1657963795823-0d4b15fa-dd25-4f31-b69f-41d3e86c874a.png">
<meta property="og:image" content="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/9286/1657957032340-19e5376d-26c2-4f7a-9889-f907abbc9567.png">
<meta property="og:image" content="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/9286/1657965751565-928964d0-e704-4f74-bd50-8253956b94cb.png">
<meta property="og:image" content="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/9286/1657966904068-aa3e5394-b0f2-4670-b6f9-624f0b19670a.png">
<meta property="og:image" content="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/9286/1657939846578-920696bc-e428-4080-abb6-14844855c99f.png">
<meta property="og:image" content="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/9286/1657939876039-0c55740d-4afb-411f-b9f9-c7b4759a7c0b.png">
<meta property="og:image" content="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/9286/1658628959263-fb501b27-9e30-494c-951a-f638d60601cb.png">
<meta property="og:image" content="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/9286/1658628979877-2a1c70de-40bf-4fc0-a27a-f47e0c461988.png">
<meta property="og:image" content="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/9286/1658665523712-67ba763c-2a85-4c82-a4fc-7f5a2d291b52.png">
<meta property="og:image" content="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/9286/1658665446221-53fe3558-920b-472b-9e89-09222f1bba6a.png">
<meta property="og:image" content="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/9286/1658665585568-ac9238e1-e992-490e-950a-6e1758fdc39a.png">
<meta property="og:image" content="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/9286/1658665654542-a805369b-37cc-4ecc-9552-bdfe9c6f6a4f.png">
<meta property="og:image" content="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/9286/1658665744490-bbbefa98-da95-4f79-943c-90b1b25d118d.png">
<meta property="og:image" content="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/9286/1658707621000-8e4516a6-9794-46e7-b774-01238c961382.png">
<meta property="og:image" content="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/9286/1658707718536-d588143a-7eac-42e1-9684-485d29776e41.png">
<meta property="og:image" content="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/9286/1658707800433-d67a29b2-0bfd-47e2-be51-e89b44d15104.png">
<meta property="og:image" content="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/9286/1658707925609-c76bb4b1-6801-4145-8f78-f20291716028.png">
<meta property="og:image" content="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/9286/1658708123401-6604d3ff-75ce-4f93-931f-5429c3cb024f.png">
<meta property="og:image" content="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/9286/1658707974817-6866d1f1-63b1-4189-96d7-565138edc5cf.png">
<meta property="og:image" content="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/9286/1658708217085-ce56ac8c-16c3-4e0e-b0b0-128ffea5e446.png">
<meta property="og:image" content="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/9286/1658708544351-d765bdb4-a935-4ab2-b3ed-103811fc5c3c.png">
<meta property="og:image" content="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/9286/1658708625232-e21cb917-f8a7-4148-bacf-9915f0db7fa7.png">
<meta property="og:image" content="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/9286/1658708672498-259ba88e-6881-4e8c-9b2f-fdf2e00e5bc8.png">
<meta property="og:image" content="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/9286/1658708995623-219d28b7-2eed-48e2-8f24-74e618d5a8f1.png">
<meta property="og:image" content="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/9286/1658709090448-1795d32c-61e5-48a0-921f-8bd36a6f6a77.png">
<meta property="og:image" content="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/9286/1658709215764-f0c8a38e-77d7-408c-9750-8f468c7c77e0.png">
<meta property="og:image" content="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/9286/1658709272752-566006c9-97d1-486a-bc6f-3c0978bf2470.png">
<meta property="og:image" content="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/9286/1658709326860-c0aa2b3b-e558-45ef-8e79-b70364574d29.png">
<meta property="og:image" content="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/9286/1658709693029-5b2f2673-fd45-4851-b282-a3e293d9699c.png">
<meta property="og:image" content="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/9286/1658710014944-536c792e-ae12-4109-af54-9eb86a2f339d.png">
<meta property="og:image" content="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/9286/1658711087069-e4bde53b-67c7-4781-b6ff-4e523496c09a.png">
<meta property="og:image" content="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/9286/1658711249503-19918b27-3ae4-46c6-8f22-58a622023a32.png">
<meta property="og:image" content="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/9286/1658711264271-60bc5167-02ab-4840-ade4-566353b5c08f.png">
<meta property="og:image" content="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/9286/1658712012599-99022c58-afee-4e13-8b7f-9ec6388fe5c3.png">
<meta property="og:image" content="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/9286/1658712110016-5ce8c804-8311-4dbb-9537-219dfdfbc092.png">
<meta property="og:image" content="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/9286/1658712212418-d44046a4-fd77-45d5-913c-928b0801ac85.png">
<meta property="og:image" content="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/9286/1658712400893-bc5e06c5-f374-4952-a0c7-dc39ea28e7f9.png">
<meta property="og:image" content="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/9286/1658712474929-3b6ce22b-a3c4-4045-bb75-91e3f5e56c27.png">
<meta property="og:image" content="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/9286/1658712560382-5ae4d756-6095-4ac8-99fb-744f00c58a1c.png">
<meta property="og:image" content="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/9286/1658712577840-0a67abae-4c2f-4b2f-abe1-0b0ff1c9a406.png">
<meta property="og:image" content="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/9286/1658713175840-9f506d1f-b120-41ed-8bba-3a36a4459525.png">
<meta property="og:image" content="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/9286/1658713261975-b749ba2a-dcff-4e87-9227-a095bb5de902.png">
<meta property="og:image" content="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/9286/1658713597379-08b9d49a-92fa-40e2-a623-3ccb35738b6c.png">
<meta property="og:image" content="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/9286/1658713642989-28df4599-5749-46d3-b601-826beab36429.png">
<meta property="article:published_time" content="2022-04-18T02:11:55.000Z">
<meta property="article:modified_time" content="2022-08-09T02:17:38.688Z">
<meta property="article:author" content="丸了鸭">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/9286/1657889912918-ff4c5ad0-c9d2-4447-ab31-2fca2a1d72c3.png"><script>(function() {
  const prefersDark = window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches
  const setting = localStorage.getItem('darken-mode') || 'auto'
  if (setting === 'dark' || (prefersDark && setting !== 'light'))
    document.documentElement.classList.toggle('dark', true)
})()</script></head><body><script src="https://code.iconify.design/2/2.1.1/iconify.min.js"></script><script>// Define global variable
IconifyProviders = {
  // Empty prefix: overwrite default API provider configuration
  '': {
    // Use custom API first, use Iconify public API as backup
    resources: [
        'https://api.iconify.design',
    ],
    // Wait for 1 second before switching API hosts
    rotate: 1000,
  },
};</script><script defer src="https://fastly.jsdelivr.net/npm/animejs@latest"></script><script defer src="/js/ui/fireworks.js" type="module"></script><canvas class="fireworks"></canvas><div class="container"><a class="sidebar-toggle hty-icon-button" id="menu-btn"><div class="hamburger hamburger--spin" type="button"><span class="hamburger-box"><span class="hamburger-inner"></span></span></div></a><div class="sidebar-toggle sidebar-overlay"></div><aside class="sidebar"><script src="/js/sidebar.js" type="module"></script><ul class="sidebar-nav"><li class="sidebar-nav-item sidebar-nav-toc hty-icon-button sidebar-nav-active" data-target="post-toc-wrap" title="文章目录"><span class="icon iconify" data-icon="ri:list-ordered"></span></li><li class="sidebar-nav-item sidebar-nav-overview hty-icon-button" data-target="site-overview-wrap" title="站点概览"><span class="icon iconify" data-icon="ri:passport-line"></span></li></ul><div class="sidebar-panel" id="site-overview-wrap"><div class="site-info fix-top"><a class="site-author-avatar" href="/about/" title="丸了鸭"><img width="96" loading="lazy" src="/images/kedaya.jpg" alt="丸了鸭"><span class="site-author-status" title="再小的努力乘以365都很明显">😎</span></a><div class="site-author-name"><a href="/about/">丸了鸭</a></div><span class="site-name">丸了鸭的博客</span><sub class="site-subtitle">记录学习生活的点点滴滴</sub><div class="site-description">信手拈来的从容，都是厚积薄发的沉淀。</div></div><nav class="site-state"><a class="site-state-item hty-icon-button icon-home" href="/" title="首页"><span class="site-state-item-icon"><span class="icon iconify" data-icon="ri:home-4-line"></span></span></a><div class="site-state-item"><a href="/archives/" title="归档"><span class="site-state-item-icon"><span class="icon iconify" data-icon="ri:archive-line"></span></span><span class="site-state-item-count">129</span></a></div><div class="site-state-item"><a href="/categories/" title="分类"><span class="site-state-item-icon"><span class="icon iconify" data-icon="ri:folder-2-line"></span></span><span class="site-state-item-count">8</span></a></div><div class="site-state-item"><a href="/tags/" title="标签"><span class="site-state-item-icon"><span class="icon iconify" data-icon="ri:price-tag-3-line"></span></span><span class="site-state-item-count">8</span></a></div><a class="site-state-item hty-icon-button" target="_blank" rel="noopener" href="https://www.kdy.icu/" title="文档"><span class="site-state-item-icon"><span class="icon iconify" data-icon="ri:settings-line"></span></span></a></nav><hr style="margin-bottom:0.5rem"><div class="links-of-author"><a class="links-of-author-item hty-icon-button" rel="noopener" href="https://github.com/cyh245689173" title="GayHub" target="_blank" style="color:#6e5494"><span class="icon iconify" data-icon="ri:github-line"></span></a><a class="links-of-author-item hty-icon-button" rel="noopener" href="https://music.163.com/#/user/home?id=1696797616" title="网抑云音乐" target="_blank" style="color:#C20C0C"><span class="icon iconify" data-icon="ri:netease-cloud-music-line"></span></a><a class="links-of-author-item hty-icon-button" rel="noopener" href="https://space.bilibili.com/248628386" title="哔哩哔哩" target="_blank" style="color:#FF8EB3"><span class="icon iconify" data-icon="ri:bilibili-line"></span></a><a class="links-of-author-item hty-icon-button" rel="noopener" href="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/9286/%E5%BE%AE%E4%BF%A1%E5%9B%BE%E7%89%87_20220729090533.jpg" title="加我微信" target="_blank" style="color:#1AAD19"><span class="icon iconify" data-icon="ri:wechat-2-line"></span></a></div><hr style="margin:0.5rem 1rem"><div class="links"><a class="links-item hty-icon-button" href="/links/" title="轻松一刻" style="color:dodgerblue"><span class="icon iconify" data-icon="ri:genderless-line"></span></a></div><br><a class="links-item hty-icon-button" id="toggle-mode-btn" href="javascript:;" title="Mode" style="color: #f1cb64"><span class="icon iconify" data-icon="ri:contrast-2-line"></span></a></div><div class="sidebar-panel sidebar-panel-active" id="post-toc-wrap"><div class="post-toc"><div class="post-toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#1-%E5%AE%8C%E6%88%90%E6%B3%A8%E5%86%8C%E5%8A%9F%E8%83%BD%E7%9A%84%E5%89%8D%E7%AB%AF%E5%BC%80%E5%8F%91"><span class="toc-text">1.完成注册功能的前端开发</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#1-1-%E6%9B%B4%E6%94%B9%E6%B3%A8%E5%86%8C%E9%A1%B5%E9%9D%A2"><span class="toc-text">1.1 更改注册页面</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#1-2-%E5%86%99%E6%8F%90%E4%BA%A4%E9%80%BB%E8%BE%91"><span class="toc-text">1.2 写提交逻辑</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#1-3-%E6%B5%8B%E8%AF%95"><span class="toc-text">1.3 测试</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#2-%E5%AE%8C%E6%88%90%E7%94%A8%E6%88%B7%E7%AE%A1%E7%90%86%E5%90%8E%E5%8F%B0%E7%9A%84%E5%89%8D%E7%AB%AF%E5%BC%80%E5%8F%91"><span class="toc-text">2. 完成用户管理后台的前端开发</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#2-1-%E5%90%8E%E7%AB%AF%E7%BC%96%E5%86%99%E8%8E%B7%E5%8F%96%E5%BD%93%E5%89%8D%E7%99%BB%E5%BD%95%E7%94%A8%E6%88%B7%E4%BF%A1%E6%81%AF%E7%9A%84%E6%8E%A5%E5%8F%A3"><span class="toc-text">2.1 后端编写获取当前登录用户信息的接口</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-1-%E5%89%8D%E7%AB%AF%E7%BC%96%E5%86%99%E8%8E%B7%E5%8F%96%E5%BD%93%E5%89%8D%E7%99%BB%E5%BD%95%E7%94%A8%E6%88%B7%E4%BF%A1%E6%81%AF%E7%9A%84%E6%8E%A5%E5%8F%A3"><span class="toc-text">2.1 前端编写获取当前登录用户信息的接口</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-3-%E7%94%A8%E6%88%B7%E7%AE%A1%E7%90%86%E5%90%8E%E5%8F%B0"><span class="toc-text">2.3 用户管理后台</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#ProComponents%E9%AB%98%E7%BA%A7%E8%A1%A8%E5%8D%95%E4%BB%8B%E7%BB%8D"><span class="toc-text">ProComponents高级表单介绍</span></a></li></ol></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#3-%E5%89%8D%E7%AB%AF%E4%BB%A3%E7%A0%81%E7%98%A6%E8%BA%AB-amp-%E4%BC%98%E5%8C%96"><span class="toc-text">3. 前端代码瘦身 &amp; 优化</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#4-%E5%90%8E%E7%AB%AF%E4%BB%A3%E7%A0%81%E4%BC%98%E5%8C%96"><span class="toc-text">4. 后端代码优化</span></a></li></ol></div></div></div></aside><main class="sidebar-translate" id="content"><div id="post"><article class="hty-card post-block" itemscope itemtype="https://schema.org/Article" style="--smc-primary:#0078E7;"><link itemprop="mainEntityOfPage" href="https://cyh245689173.github.io/2022/04/18/%E7%94%A8%E6%88%B7%E4%B8%AD%E5%BF%83%E9%A1%B9%E7%9B%AE%E7%BB%88%E7%AC%94%E8%AE%B0/"><span hidden itemprop="author" itemscope itemtype="https://schema.org/Person"><meta itemprop="name" content="丸了鸭"><meta itemprop="description"></span><span hidden itemprop="publisher" itemscope itemtype="https://schema.org/Organization"><meta itemprop="name" content="丸了鸭的博客"></span><header class="post-header"><h1 class="post-title" itemprop="name headline">用户中心项目终笔记</h1><div class="post-meta"><div class="post-time" style="display:block"><span class="post-meta-item-icon"><span class="icon iconify" data-icon="ri:calendar-line"></span></span> <span class="post-meta-icon-text">发表于</span> <time title="创建时间：2022-04-18 10:11:55" itemprop="dateCreated datePublished" datetime="2022-04-18T10:11:55+08:00">2022-04-18</time><span class="post-meta-divider">-</span><span class="post-meta-item-icon"><span class="icon iconify" data-icon="ri:calendar-2-line"></span></span> <span class="post-meta-icon-text">更新于</span> <time title="修改时间：2022-08-09 10:17:38" itemprop="dateModified" datetime="2022-08-09T10:17:38+08:00">2022-08-09</time></div><span class="post-count"><span class="post-symbolcount"><span class="post-meta-item-icon" title="本文字数"><span class="icon iconify" data-icon="ri:file-word-line"></span></span> <span title="本文字数">3.4k</span><span class="post-meta-divider">-</span><span class="post-meta-item-icon" title="阅读时长"><span class="icon iconify" data-icon="ri:timer-line"></span></span> <span title="阅读时长">13m</span></span></span><span class="leancloud_visitors" id="/2022/04/18/%E7%94%A8%E6%88%B7%E4%B8%AD%E5%BF%83%E9%A1%B9%E7%9B%AE%E7%BB%88%E7%AC%94%E8%AE%B0/" data-flag-title="用户中心项目终笔记"><span class="post-meta-divider">-</span><span class="post-meta-item-icon" title="阅读次数"><span class="icon iconify" data-icon="ri:eye-line"></span> <span class="leancloud-visitors-count"></span></span></span><div class="post-classify"><span class="post-category"> <span class="post-meta-item-icon" style="margin-right:3px;"><span class="icon iconify" data-icon="ri:folder-line"></span></span><span itemprop="about" itemscope itemtype="https://schema.org/Thing"><a class="category-item" href="/categories/%E9%A1%B9%E7%9B%AE/" style="--text-color:var(--hty-text-color)" itemprop="url" rel="index"><span itemprop="text">项目</span></a></span></span></div></div></header><section class="post-body" itemprop="articleBody"><div class="post-content markdown-body"><h1 id="1-完成注册功能的前端开发"><a href="#1-完成注册功能的前端开发" class="headerlink" title="1.完成注册功能的前端开发"></a>1.完成注册功能的前端开发</h1><p>我发现我的user目录下已经有一个register文件夹了</p>
<p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/9286/1657889912918-ff4c5ad0-c9d2-4447-ab31-2fca2a1d72c3.png" alt="img" loading="lazy"></p>
<p>运行效果是酱婶的</p>
<p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/9286/1657889874523-e08d0c36-e0ee-4447-8f2f-59cb8f3b0357.png" alt="img" loading="lazy"></p>
<p>改起来忒麻烦，直接删掉，按照鱼皮的来。</p>
<hr>
<p>首先将登录部分代码复制一份名称改为Register也放在user目录下，然后打开Register中的index.tsx文件进行改造，将以下两处的Login替换为Register。</p>
<p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/9286/1657890681042-bbab1d0e-f49e-4799-96df-560a20e9d2ce.png" alt="img" loading="lazy"></p>
<p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/9286/1657890729270-68af2349-2ec4-4376-90ee-12ca17972efc.png" alt="img" loading="lazy"></p>
<p>然后打开config目录下的routes.ts文件进行路由的添加</p>
<p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/9286/1657886603994-a58bdfd2-8e5d-4bad-b9c6-7c486e542161.png" alt="img" loading="lazy"></p>
<p>添加注册路由</p>
<p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/9286/1657886630202-18447bf5-1cdc-4a7e-902d-5ce1c339199c.png" alt="img" loading="lazy"></p>
<p>app.tsx 是这个前端项目的全局文件，它里面定义了刚进入页面时要执行的逻辑。</p>
<p>然后这个框架更类似于一个后台管理系统，所以每个页面都会进行校验，如果用户没登录或者没有登陆信息，就会被重定向到登录页面。</p>
<p>首先，将这行代码注释掉</p>
<p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/9286/1657889722720-6b75a992-fc77-4ebb-b28b-7abfe49053d7.png" alt="img" loading="lazy"></p>
<p>然后编写业务逻辑，将注册页面添加至白名单</p>
<p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/9286/1657889762246-892af0e4-e4aa-4d2b-8555-2b79e578bea0.png" alt="img" loading="lazy"></p>
<p>代码如下：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">*//将注册页面设置到白名单</span><br><span class="line">*const whiteList = [&#x27;/user/register&#x27;,loginPath];if (whiteList.includes(location.pathname))&#123;  return;&#125;</span><br></pre></td></tr></table></figure>



<p>然后就可以正常访问啦</p>
<p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/9286/1657891058842-e7c327f3-9f63-4fcf-a153-a98f16e2a416.png" alt="img" loading="lazy"></p>
<h2 id="1-1-更改注册页面"><a href="#1-1-更改注册页面" class="headerlink" title="1.1 更改注册页面"></a>1.1 更改注册页面</h2><p>首先，这里改为账号密码注册</p>
<p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/9286/1657929006411-f2d6353c-32c5-46b8-8dbd-f0484a200e41.png" alt="img" loading="lazy"></p>
<p>然后复制一下密码表单项，用于改写密码确认表单项</p>
<p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/9286/1657929097952-5c1e1094-391d-4bd0-abfb-8ae5ba9a42a4.png" alt="img" loading="lazy"></p>
<p>添加确认密码表单项（每一个表单项都有一个唯一的name，框架会提取这个name和我们输入的值，将其转化为一个对象，然后我们就可以从这个对象中取出我们需要的值，我的理解是框架是根据name的值来进行取值的，类似于一个类的类名）</p>
<p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/9286/1657929256859-303f9c33-c18d-45f1-b0c7-f21770bbbe50.png" alt="img" loading="lazy"></p>
<p>代码：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;ProFormText.Password  name=&quot;checkPassword&quot;  fieldProps=&#123;&#123;    size: &#x27;large&#x27;,    prefix: &lt;LockOutlined className=&#123;styles.prefixIcon&#125; /&gt;,  &#125;&#125;  placeholder=&#123;&#x27;请确认密码&#x27;&#125;  rules=&#123;[    &#123;      required: true,      message: &#x27;确认密码是必填项！&#x27;,    &#125;,    &#123;      min :8,      type :&#x27;string&#x27;,      message: &#x27;密码长度不能低于8位！&#x27;,    &#125;,  ]&#125;/&gt;</span><br></pre></td></tr></table></figure>

<p>自动登录和忘记密码删了</p>
<p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/9286/1657929486713-9b5ae9ef-7d4d-4fc9-bf38-14947d33bd64.png" alt="img" loading="lazy"></p>
<p>然后全局替换，把登录改为注册</p>
<p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/9286/1657929853874-aa94116e-c7d7-4486-bfcd-b00f9a6fae44.png" alt="img" loading="lazy"></p>
<p>运行看一下，这样页面就精简多了</p>
<p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/9286/1657929884818-7809af12-a405-4a23-9e54-0383180fffcb.png" alt="img" loading="lazy"></p>
<p>但是可以看到，这里仍然是登录而不是注册，因为当前页面已经全局替换过了，所以应该是进行了封装，追踪源码</p>
<p>那么如何追踪源码捏，下面是具体的步骤：</p>
<p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/9286/1657930251178-71d82e55-fe01-4d4f-a6cc-dbd0296ff933.png" alt="img" loading="lazy"></p>
<p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/9286/1657930575638-3c4f8fa0-d81a-4afc-a378-7a8d24f8715b.png" alt="img" loading="lazy"></p>
<p>进入源码文件，诶嘿，看我们发现了什么</p>
<p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/9286/1657930768149-178e9770-4346-4891-a7e9-029c3b3443a1.png" alt="img" loading="lazy"></p>
<p>照葫芦画瓢，我们在注册页面添加如下代码：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">submitter=&#123;&#123;    searchConfig: &#123;      submitText: &quot;注册&quot;    &#125;  &#125;&#125;</span><br></pre></td></tr></table></figure>

<p>效果如下图：</p>
<p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/9286/1657930951224-e4067efa-5b52-4354-99fb-03011a636e66.png" alt="img" loading="lazy"></p>
<p>在运行看一下。（还是那句话，一定随时改随时查，可以知道自己错在了哪一步）</p>
<p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/9286/1657931058002-a99d87e6-5e03-4174-843b-bc3bcbcdca8d.png" alt="img" loading="lazy"></p>
<p>芜湖~ 成功了~</p>
<h2 id="1-2-写提交逻辑"><a href="#1-2-写提交逻辑" class="headerlink" title="1.2 写提交逻辑"></a>1.2 写提交逻辑</h2><p>首先，修改注册所需的参数，找到图中所示位置，点击进入</p>
<p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/9286/1657933347356-9479626c-df34-4eee-b003-3e034627ddb5.png" alt="img" loading="lazy"></p>
<p>然后就到了我最喜欢的CV环节，复制登录的参数，修改一下</p>
<p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/9286/1657933456731-6b53881b-1a22-44f3-9184-9429f216920b.png" alt="img" loading="lazy"></p>
<p>代码：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">type RegisterParams = &#123;  userAccount?: string;  userPassword?: string;  checkPassword?: string;  type?: string;&#125;;</span><br></pre></td></tr></table></figure>



<p>回到index.tsx，将登录参数全部改为注册参数。</p>
<p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/9286/1657933619411-0c6fde57-fd85-4016-953c-a5c9296efdcf.png" alt="img" loading="lazy"></p>
<p>添加校验逻辑</p>
<p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/9286/1657933850640-705afb35-bb0b-4e03-a738-52a3d28eb478.png" alt="img" loading="lazy"></p>
<p>代码：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">const &#123;userPassword,checkPassword&#125; = values;*//校验</span><br><span class="line">*if (userPassword !== checkPassword)&#123;  message.error(&#x27;两次输入的密码不一致&#x27;);  return;&#125;</span><br></pre></td></tr></table></figure>

<p>然后点击进入登录接口逻辑<img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/9286/1657933971492-4cfa9844-b359-41be-a5ce-68dd06f06f2a.png" alt="img" loading="lazy"></p>
<p>然后开始CV，把代码修改一下</p>
<p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/9286/1657934241825-0e4093f9-3170-42f1-9c95-c6feeaa8a79b.png" alt="img" loading="lazy"></p>
<p>发现这里有个登陆接口的返回值，点进去CV，首先看一下后端返回的是什么类型的数据</p>
<p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/9286/1657934451859-e338a271-f53b-4717-a8b2-cb8fda1a7b81.png" alt="img" loading="lazy"></p>
<p>发现后端返回的是long类型，那我们前段就用number来接收</p>
<p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/9286/1657934501593-4fefc3d4-a3f8-4bd4-98d9-5d22f3dd851c.png" alt="img" loading="lazy"></p>
<p>然后回到接口页面，将返回值改成RegisterResult</p>
<p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/9286/1657934567130-989ef4e8-3a80-4363-b232-7a0262bd951d.png" alt="img" loading="lazy"></p>
<p>然后再回到index.tsx页面编写注册逻辑</p>
<p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/9286/1657935046287-c1750885-e277-4f93-ae95-ef6a46bef8ff.png" alt="img" loading="lazy"></p>
<p>代码如下：</p>
<p>&#96;try {  <em>&#x2F;&#x2F; 注册<br>*  const id &#x3D; await <em>register</em>(values);  if (id &gt; 0) {    const defaultLoginSuccessMessage &#x3D; ‘注册成功！’;    message.success(defaultLoginSuccessMessage);    <em>&#x2F;</em></em> 此方法会跳转到 redirect 参数所在的位置 *&#x2F;</p>
<p>*    if (!history) return;    const {query} &#x3D; history.location;    const {redirect} &#x3D; query as {      redirect: string;    };    history.push(‘&#x2F;user&#x2F;login?redirect&#x3D;’+redirect);    return;  }else {    *&#x2F;&#x2F;记录下id的值，方便以后排错<br>*    throw new Error(‘register error id &#x3D; ${id}’)  }} catch (error) {  const defaultLoginFailureMessage &#x3D; ‘注册失败，请重试！’;  message.error(defaultLoginFailureMessage);}&#96;</p>
<p>然后爆红的位置全部删了就行，或者使用Ctrl+Alt+O清除。</p>
<p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/9286/1657935134377-89b7a49b-814b-4201-8377-f1d96bf04d8c.png" alt="img" loading="lazy"></p>
<p>然后就是删删删环节，哪里红了删哪里，记得边删边运行，不能删的赶紧恢复回来。</p>
<p>运行一下，发现没毛病。</p>
<p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/9286/1657935540467-94a513cd-24f6-45ff-b1b8-5238169f64f9.png" alt="img" loading="lazy"></p>
<p>然后我们来到激动人心的测试环节</p>
<h2 id="1-3-测试"><a href="#1-3-测试" class="headerlink" title="1.3 测试"></a>1.3 测试</h2><ol>
<li>后端打上断点，debug模式启动</li>
</ol>
<p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/9286/1657935640340-199c5991-a979-405e-865c-1d4e00c1df99.png" alt="img" loading="lazy"></p>
<p>前端也打开开发者模式进行调试</p>
<p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/9286/1657935690773-60e193f1-95b1-47cf-9bd2-c127ef763c32.png" alt="img" loading="lazy"></p>
<p>然后发现后端接收到了参数</p>
<p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/9286/1657935724306-73def634-64a9-4ea4-913d-5312cb0c8d1f.png" alt="img" loading="lazy"></p>
<p>但是因为Debug超时，所以我们把超时时间调长一点，尽量长一点，比如100000</p>
<p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/9286/1657935882619-03653bdb-1ee7-4d16-b0f9-cfdd0a41d81e.png" alt="img" loading="lazy"></p>
<p>重新测试，然后发现返回值-1</p>
<p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/9286/1657935956380-586c0e60-4637-4d4f-a054-de8a1aca5591.png" alt="img" loading="lazy"></p>
<p>这是因为我们数据库里已经有bubble账户了，那我们重新建一个</p>
<p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/9286/1657936056309-ac2061ff-9a27-47cb-ad6e-597a45623021.png" alt="img" loading="lazy"></p>
<p>然后发现新建成功，数据库中也有数据了</p>
<p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/9286/1657936101044-e3d228b1-13e1-4e11-853b-4141f6ef993f.png" alt="img" loading="lazy"></p>
<p>但是注册成功也没有一个比较友好的提示，后期要优化一下</p>
<p>并且可以发现url哪里重定向有点小bug，进行修复一下</p>
<p>在index.tsx页面修改一下以下代码</p>
<p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/9286/1657936278820-48beea7e-034e-4ce6-8a15-5c20bbd22fe4.png" alt="img" loading="lazy"></p>
<p>代码：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">if (!history) return;const &#123;query&#125; = history.location;history.push(&#123;  pathname:&#x27;user/login&#x27;,  query&#125;);return;</span><br></pre></td></tr></table></figure>

<p>然后运行，效果好多了。</p>
<p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/9286/1657937026330-3043d74e-9539-416a-910f-047dd2a201ba.png" alt="img" loading="lazy"></p>
<p>然后又发现登录页面没有注册的链接，去Login的index.tsx添加如下代码：（很明显，皮总有强迫症，这里纠结了一年(<em>^▽^</em>)）</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;Space split=&#123;&lt;Divider type=&quot;vertical&quot;/&gt;&#125;&gt;  &lt;ProFormCheckbox noStyle name=&quot;autoLogin&quot;&gt;    自动登录  &lt;/ProFormCheckbox&gt;  &lt;Link to=&quot;/user/register&quot;&gt;新用户注册&lt;/Link&gt;  &lt;a    style=&#123;&#123;      float: &#x27;right&#x27;,    &#125;&#125;    href=&#123;PLANET_LINK&#125;    target=&quot;_blank&quot; rel=&quot;noreferrer&quot;  &gt;    忘记密码  &lt;/a&gt;&lt;/Space&gt;</span><br></pre></td></tr></table></figure>



<p>效果如图：</p>
<p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/9286/1657936752623-31c12494-f262-4a2d-a7a7-41f0b6da269b.png" alt="img" loading="lazy"></p>
<p>运行效果（看着还行）：</p>
<p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/9286/1657936806426-9304ee27-a66c-4b3b-9d37-8e7dcb6770b8.png" alt="img" loading="lazy"></p>
<h1 id="2-完成用户管理后台的前端开发"><a href="#2-完成用户管理后台的前端开发" class="headerlink" title="2. 完成用户管理后台的前端开发"></a>2. 完成用户管理后台的前端开发</h1><h2 id="2-1-后端编写获取当前登录用户信息的接口"><a href="#2-1-后端编写获取当前登录用户信息的接口" class="headerlink" title="2.1 后端编写获取当前登录用户信息的接口"></a>2.1 后端编写获取当前登录用户信息的接口</h2><p>在后端Controller中编写以下代码：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">@GetMapping***(*****&quot;/current&quot;*****)</span><br><span class="line">*****public** User getCurrentUser***(***HttpServletRequest request***) &#123;***</span><br></pre></td></tr></table></figure>

<p><em>&#x2F;&#x2F;获取用户登录态</em>&#96;***<br>***    Object userObj &#x3D; request.getSession***()<em><strong>.getAttribute</strong></em>(USER_LOGIN_STATE)***;    User currentUser &#x3D; <em><strong>(<em><strong>User</strong></em>)</strong></em> userObj;    *&#x2F;&#x2F;如果当前用户为空，直接返回null<br>*    <strong>if</strong> ***(<em><strong>currentUser &#x3D;&#x3D; <strong>null</strong></strong></em>) {<br>***        <strong>return null</strong>;    <em><strong>}<br>***    <em>&#x2F;&#x2F;获取当前用户ID<br>*    Long currentUserId &#x3D; currentUser.getId</em></strong>()</em>**;    *&#x2F;&#x2F;****TODO 校验用户是否合法</p>
<p>***    User user &#x3D; <strong>userService</strong>.getById***(<em><strong>currentUserId</strong></em>)<em><strong>;    <em>&#x2F;&#x2F;脱敏<br>*    <strong>return</strong> <strong>userService</strong>.getSafetyUser</em></strong>(<em><strong>user</strong></em>)</em><strong>;</strong><em>}</em>**&#96;</p>
<p>效果如图：</p>
<p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/9286/1657940599623-67a23b98-5c61-4855-94dc-e5b7fa1c7ab5.png" alt="img" loading="lazy"></p>
<p>然后发现ServiceImpl中的脱敏操作中没有判空操作</p>
<p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/9286/1657940560990-6aec8bd7-13b0-4540-8cd9-4d9cda2a4a85.png" alt="img" loading="lazy"></p>
<p>进行添加：</p>
<p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/9286/1657940737884-3a21f74f-0ed8-4237-8326-6ef1f3522a83.png" alt="img" loading="lazy"></p>
<h2 id="2-1-前端编写获取当前登录用户信息的接口"><a href="#2-1-前端编写获取当前登录用户信息的接口" class="headerlink" title="2.1 前端编写获取当前登录用户信息的接口"></a>2.1 前端编写获取当前登录用户信息的接口</h2><p>首先在app.tsx中找到queryCurrentUser，点击进入当前用户的接口</p>
<p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/9286/1657941126110-998b9e7e-b2df-406a-80df-ddfd19ebfae0.png" alt="img" loading="lazy"></p>
<p>然后将下面这段代码进行修改</p>
<p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/9286/1657941195656-f908bdbe-4993-4547-b42d-7b99517f73e5.png" alt="img" loading="lazy"></p>
<p>改成下面这个样子（我也不懂前端，这里皮总踩坑的步骤就直接给省略了）</p>
<p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/9286/1657941328796-ac025b6f-4af4-4523-ae00-a051e8d740b3.png" alt="img" loading="lazy"></p>
<p>代码：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">*/** 获取当前的用户 GET /api/user/current \*/</span><br><span class="line">*export async function *currentUser*(options?: &#123; [key: string]: any &#125;) &#123;  return *request*&lt;API.CurrentUser&gt;(&#x27;/api/user/current&#x27;, &#123;    method: &#x27;GET&#x27;,    ...(options || &#123;&#125;),  &#125;);&#125;</span><br></pre></td></tr></table></figure>

<p>然后回到app.tsx，点击进入到CurrentUser中都有些什么参数</p>
<p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/9286/1657941454484-8dd5fe1a-8ded-4cdc-b9eb-85d141d76a0c.png" alt="img" loading="lazy"></p>
<p>然后发现给提供了这么多的参数，把这些参数进行注释，更换为我们数据库中的字段参数</p>
<p>代码：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">*//这里的？代表能不能为空，加了代表是不是必填</span><br><span class="line">*id: number;username: string;userAccount: string;avatarUrl?: string;gender: number;phone: string;email: string;userStatus: number;createTime: Date;userRole: number;</span><br></pre></td></tr></table></figure>

<p>效果如下：</p>
<p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/9286/1657957540828-5b9335fe-4942-41cd-ac4a-d0684588dd5b.png" alt="img" loading="lazy"></p>
<p>然后回到app.tsx中，修改获取用户信息的方法</p>
<p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/9286/1657942006481-7f7bae16-53d1-4114-98c9-d39dd89b33af.png" alt="img" loading="lazy"></p>
<p>修改为：</p>
<p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/9286/1657942106821-a030e95b-2557-4d2a-8103-ec5a93046190.png" alt="img" loading="lazy"></p>
<p>然后将白名单提到上面，然后<strong>Shift+F6进行重构</strong>为NO_NEND_LOGIN_WHITE_LIST（免登录白名单）<img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/9286/1657954970730-966238c6-43c1-4038-a3ee-d306a50c0883.png" alt="img" loading="lazy"></p>
<p>即改为下面这样</p>
<p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/9286/1657955151666-e0db2a4c-9879-472e-8c6e-8ebe33a3e8c0.png" alt="img" loading="lazy"></p>
<p>然后改这里的路径拦截：</p>
<p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/9286/1657955242734-d14f3065-8180-45a1-bce9-a1760bd67dfb.png" alt="img" loading="lazy"></p>
<p>将其改为：</p>
<p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/9286/1657955639052-71058bd1-0c4b-4497-8c49-d4d7765a6c23.png" alt="img" loading="lazy"></p>
<p>代码：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">if (NO_NEND_LOGIN_WHITE_LIST.includes(history.location.pathname)) &#123;  return &#123;    *// @ts-ignore</span><br><span class="line">\*    fetchUserInfo,    settings: defaultSettings,  &#125;;&#125;*// eslint-disable-next-line @typescript-eslint/no-shadow</span><br><span class="line">*const currentUser = await fetchUserInfo();return &#123;  *// @ts-ignore</span><br><span class="line">\*  fetchUserInfo,  currentUser,  settings: defaultSettings,&#125;;</span><br></pre></td></tr></table></figure>



<p>然后发现还有一个错，水印，这里的name改为username</p>
<p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/9286/1657955744429-ad40417d-64eb-403b-9e26-0842455b85cb.png" alt="img" loading="lazy"></p>
<p>然后运行，输入账号密码点击登录，登陆成功！</p>
<p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/9286/1657955903243-bb8a5006-edc9-4ddc-aec8-9bfe51a38e70.png" alt="img" loading="lazy"></p>
<p>但是发现，我们既没有用户名的水印，也没有头像，这是为啥呢</p>
<p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/9286/1657955939321-e59aa4e2-822b-4726-96fb-e4ef4e96fc2e.png" alt="img" loading="lazy"></p>
<p>emmm，因为我们就没加，去数据库里进行数据添加。</p>
<p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/9286/1657956061895-a76ee92b-727a-4a7e-aaef-1b6cb1102bae.png" alt="img" loading="lazy"></p>
<p>然后刷新页面，发现返回了数据，但是头像和水印仍然没有显示</p>
<p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/9286/1657963795823-0d4b15fa-dd25-4f31-b69f-41d3e86c874a.png" alt="img" loading="lazy"></p>
<p>可能是我们的字段名和前端对应不上的问题</p>
<p>全局搜索avatardropdown</p>
<p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/9286/1657957032340-19e5376d-26c2-4f7a-9889-f907abbc9567.png" alt="img" loading="lazy"></p>
<p>打开AvatarDropdown.tsx文件</p>
<p>将avatar重构为avatarUrl，name换为username<strong>（根据自己实际数据库中的字段名来，我的是userName，因为这个字段名的一个大小写，我废了两三个小时。。。。。一定要严谨啊）</strong></p>
<p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/9286/1657965751565-928964d0-e704-4f74-bd50-8253956b94cb.png" alt="img" loading="lazy"></p>
<p>然后刷新页面，看一下，头像已经可以出来了</p>
<p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/9286/1657966904068-aa3e5394-b0f2-4670-b6f9-624f0b19670a.png" alt="img" loading="lazy"></p>
<p>但是水印还是没有出来，改了好久也不知道是哪里的问题，先留着吧，以后用到了再说。</p>
<h2 id="2-3-用户管理后台"><a href="#2-3-用户管理后台" class="headerlink" title="2.3 用户管理后台"></a>2.3 用户管理后台</h2><p>搞了半天我发现我没有装umi-ui</p>
<p>在终端输入如下命令：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yarn add @umijs/preset-ui -D</span><br></pre></td></tr></table></figure>

<p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/9286/1657939846578-920696bc-e428-4080-abb6-14844855c99f.png" alt="img" loading="lazy"></p>
<p>然后等待安装完成，刷新页面，这碗小米饭就出来了。</p>
<p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/9286/1657939876039-0c55740d-4afb-411f-b9f9-c7b4759a7c0b.png" alt="img" loading="lazy"></p>
<p>首先，在pages文件夹下新建一个文件夹名为admin</p>
<p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/9286/1658628959263-fb501b27-9e30-494c-951a-f638d60601cb.png" alt="img" loading="lazy"></p>
<p>然后将user文件夹下的Register文件夹复制到admin文件夹中并改名为UserManage</p>
<p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/9286/1658628979877-2a1c70de-40bf-4fc0-a27a-f47e0c461988.png" alt="img" loading="lazy"></p>
<p>在routes.ts下添加路由</p>
<p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/9286/1658665523712-67ba763c-2a85-4c82-a4fc-7f5a2d291b52.png" alt="img" loading="lazy"></p>
<p>访问一下，发现无权访问</p>
<p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/9286/1658665446221-53fe3558-920b-472b-9e89-09222f1bba6a.png" alt="img" loading="lazy"></p>
<p>这是因为ant desgin中包含了权限控制，如下图，admin的路由只能管理员进行访问</p>
<p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/9286/1658665585568-ac9238e1-e992-490e-950a-6e1758fdc39a.png" alt="img" loading="lazy"></p>
<p>按住Ctrl点击进入CanAdmin，发现我们进入了access.ts文件</p>
<p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/9286/1658665654542-a805369b-37cc-4ecc-9552-bdfe9c6f6a4f.png" alt="img" loading="lazy"></p>
<p>access.ts文件中定义了对用户的访问权限，我们将它改为我们的管理员鉴权操作，即userRole，如下图</p>
<p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/9286/1658665744490-bbbefa98-da95-4f79-943c-90b1b25d118d.png" alt="img" loading="lazy"></p>
<p>重新访问 ，发现可以了</p>
<p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/9286/1658707621000-8e4516a6-9794-46e7-b774-01238c961382.png" alt="img" loading="lazy"></p>
<p>但是这并不是我们放在UserManage中的注册页面，这是怎么回事呢？</p>
<p>这是因为Admin.ts已经把页面写死了</p>
<p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/9286/1658707718536-d588143a-7eac-42e1-9684-485d29776e41.png" alt="img" loading="lazy"></p>
<p>我们需要对他进行改写，首先将图中内容删除</p>
<p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/9286/1658707800433-d67a29b2-0bfd-47e2-be51-e89b44d15104.png" alt="img" loading="lazy"></p>
<p>然后进行改写，在下图中的位置通过引入children属性来添加子页面</p>
<p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/9286/1658707925609-c76bb4b1-6801-4145-8f78-f20291716028.png" alt="img" loading="lazy"></p>
<p>也可以这么写</p>
<p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/9286/1658708123401-6604d3ff-75ce-4f93-931f-5429c3cb024f.png" alt="img" loading="lazy"></p>
<p>效果都是从当前页面读取页面的子路由从而得到当前页面的子页面。</p>
<p>刷新页面，发现子页面出来了</p>
<p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/9286/1658707974817-6866d1f1-63b1-4189-96d7-565138edc5cf.png" alt="img" loading="lazy"></p>
<p>美观一下，把这里删了</p>
<p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/9286/1658708217085-ce56ac8c-16c3-4e0e-b0b0-128ffea5e446.png" alt="img" loading="lazy"></p>
<p>然后开始改造我们的用户管理页面，将图中标记的代码全部删掉</p>
<p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/9286/1658708544351-d765bdb4-a935-4ab2-b3ed-103811fc5c3c.png" alt="img" loading="lazy"></p>
<p>然后将其改造为下图这样，给div一个唯一标识，这样方便以后通过css来更好的修改样式</p>
<p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/9286/1658708625232-e21cb917-f8a7-4148-bacf-9915f0db7fa7.png" alt="img" loading="lazy"></p>
<p>然后对Register进行全局替换，替换为UserManage</p>
<p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/9286/1658708672498-259ba88e-6881-4e8c-9b2f-fdf2e00e5bc8.png" alt="img" loading="lazy"></p>
<p>然后我们开始添加组件，组件地址：<a target="_blank" rel="noopener" href="https://procomponents.ant.design/">组件库</a></p>
<p>选择高级表格</p>
<p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/9286/1658708995623-219d28b7-2eed-48e2-8f24-74e618d5a8f1.png" alt="img" loading="lazy"></p>
<p>然后找到我们想要的组件，第一个就不错，直接<strong>CV</strong></p>
<p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/9286/1658709090448-1795d32c-61e5-48a0-921f-8bd36a6f6a77.png" alt="img" loading="lazy"></p>
<p>直接覆盖掉原来用户管理的页面</p>
<p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/9286/1658709215764-f0c8a38e-77d7-408c-9750-8f468c7c77e0.png" alt="img" loading="lazy"></p>
<p>然后开始改造页面</p>
<p>这个菜单用不到，删掉。</p>
<p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/9286/1658709272752-566006c9-97d1-486a-bc6f-3c0978bf2470.png" alt="img" loading="lazy"></p>
<p>工具栏用不到，删掉。</p>
<p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/9286/1658709326860-c0aa2b3b-e558-45ef-8e79-b70364574d29.png" alt="img" loading="lazy"></p>
<p>然后刷新页面，发现效果就出来了</p>
<p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/9286/1658709693029-5b2f2673-fd45-4851-b282-a3e293d9699c.png" alt="img" loading="lazy"></p>
<p>然后继续改造，第一个红框部分删除</p>
<p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/9286/1658710014944-536c792e-ae12-4109-af54-9eb86a2f339d.png" alt="img" loading="lazy"></p>
<hr>
<h4 id="ProComponents高级表单介绍"><a href="#ProComponents高级表单介绍" class="headerlink" title="ProComponents高级表单介绍"></a>ProComponents高级表单介绍</h4><ol>
<li><p>columns定义表格的列</p>
</li>
<li><p>columns属性</p>
</li>
<li><ol>
<li>dataIndex：对应返回数据对象的属性</li>
<li>title：表格所展示的列名</li>
<li>copyable：是否可复制</li>
<li>ellipsis：是否允许缩略</li>
<li>valueType：用于声明这一列的类型</li>
</ol>
</li>
</ol>
<hr>
<p>然后开始改造表格的列，将表格改为我们数据库中的所需要的字段名，代码如下：（记得要改的是自己数据库中的字段名，我的userName，你们的可能是username，要和自己的对应，不然出错不好找）</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&#123;  dataIndex: &#x27;id&#x27;,  valueType: &#x27;indexBorder&#x27;,  width: 48,&#125;,&#123;  title: &#x27;用户名&#x27;,  dataIndex: &#x27;userName&#x27;,  copyable: true,&#125;,&#123;  title: &#x27;用户账户&#x27;,  dataIndex: &#x27;userAccount&#x27;,  copyable: true,&#125;,&#123;  title: &#x27;头像&#x27;,  dataIndex: &#x27;avatarUrl&#x27;,  copyable: true,&#125;,&#123;  title: &#x27;性别&#x27;,  dataIndex: &#x27;gender&#x27;,&#125;,&#123;  title: &#x27;电话&#x27;,  dataIndex: &#x27;phone&#x27;,  copyable: true,&#125;,&#123;  title: &#x27;邮件&#x27;,  dataIndex: &#x27;email&#x27;,  copyable: true,&#125;,&#123;  title: &#x27;状态&#x27;,  dataIndex: &#x27;userStatus&#x27;,&#125;,&#123;  title: &#x27;角色&#x27;,  dataIndex: &#x27;userRole&#x27;,&#125;,&#123;  title: &#x27;创建时间&#x27;,  dataIndex: &#x27;createTime&#x27;,</span><br><span class="line">valueType: &#x27;dateTime&#x27;,``&#125;,</span><br></pre></td></tr></table></figure>

<p>效果如图：</p>
<p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/9286/1658711087069-e4bde53b-67c7-4781-b6ff-4e523496c09a.png" alt="img" loading="lazy"></p>
<p>然后将一下代码注释掉：</p>
<p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/9286/1658711249503-19918b27-3ae4-46c6-8f22-58a622023a32.png" alt="img" loading="lazy"></p>
<p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/9286/1658711264271-60bc5167-02ab-4840-ade4-566353b5c08f.png" alt="img" loading="lazy"></p>
<p>然后列写完了，开始改写组件，首先我们需要写一个查询用户的接口，在api.ts文件中添加，将以下代码进行改写</p>
<p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/9286/1658712012599-99022c58-afee-4e13-8b7f-9ec6388fe5c3.png" alt="img" loading="lazy"></p>
<p>改写为</p>
<p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/9286/1658712110016-5ce8c804-8311-4dbb-9537-219dfdfbc092.png" alt="img" loading="lazy"></p>
<p>代码如下：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">*/** 用户查询 GET /api/user/search \*/</span><br><span class="line">*export async function *searchUsers*(options?: &#123; [key: string]: any &#125;) &#123;  return *request*&lt;API.NoticeIconList&gt;(&#x27;/api/user/search&#x27;, &#123;    method: &#x27;GET&#x27;,    ...(options || &#123;&#125;),  &#125;);&#125;</span><br></pre></td></tr></table></figure>

<p>然后回到index.tsx改写以下代码</p>
<p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/9286/1658712212418-d44046a4-fd77-45d5-913c-928b0801ac85.png" alt="img" loading="lazy"></p>
<p>改写为</p>
<p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/9286/1658712400893-bc5e06c5-f374-4952-a0c7-dc39ea28e7f9.png" alt="img" loading="lazy"></p>
<p>然后刷新页面试试（记得使用管理员身份登录才可以查询得到）</p>
<p>当当当当！</p>
<p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/9286/1658712474929-3b6ce22b-a3c4-4045-bb75-91e3f5e56c27.png" alt="img" loading="lazy"></p>
<p>但是我的头像这一栏怎么这么长，把可缩略添加上</p>
<p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/9286/1658712560382-5ae4d756-6095-4ac8-99fb-744f00c58a1c.png" alt="img" loading="lazy"></p>
<p>再次刷新页面</p>
<p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/9286/1658712577840-0a67abae-4c2f-4b2f-abe1-0b0ff1c9a406.png" alt="img" loading="lazy"></p>
<p>但是我们发现头像显示的是链接，不是图片，这里可以修改一下头像的渲染逻辑。</p>
<p>改为如下代码，因为已经是显示图片了，就不用缩略了，注释就好了</p>
<p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/9286/1658713175840-9f506d1f-b120-41ed-8bba-3a36a4459525.png" alt="img" loading="lazy"></p>
<p>代码如下：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&#123;  title: &#x27;头像&#x27;,  dataIndex: &#x27;avatarUrl&#x27;,  *// ellipsis: true,</span><br><span class="line">\*  render: (_, record) =&gt; (    &lt;div&gt;      &lt;Image src=&#123;record.avatarUrl&#125; width=&#123;100&#125;/&gt;    &lt;/div&gt;  ),  copyable: true,&#125;,</span><br></pre></td></tr></table></figure>



<p>刷新页面</p>
<p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/9286/1658713261975-b749ba2a-dcff-4e87-9227-a095bb5de902.png" alt="img" loading="lazy"></p>
<p>头像成功显示，但是用户角色一栏显示0和1感觉不太友好，优化一下</p>
<p>在角色部分添加以下代码</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">valueEnum: &#123;  0:&#123;text:&#x27;普通用户&#x27;,    status:&#x27;Default&#x27;,  &#125;,  1:&#123;    text:&#x27;管理员&#x27;,    status:&#x27;Success&#x27;,  &#125;&#125;</span><br></pre></td></tr></table></figure>

<p>效果如图：</p>
<p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/9286/1658713597379-08b9d49a-92fa-40e2-a623-3ccb35738b6c.png" alt="img" loading="lazy"></p>
<p>刷新页面，显示成功，完美！</p>
<p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/9286/1658713642989-28df4599-5749-46d3-b601-826beab36429.png" alt="img" loading="lazy"></p>
<h1 id="3-前端代码瘦身-amp-优化"><a href="#3-前端代码瘦身-amp-优化" class="headerlink" title="3. 前端代码瘦身 &amp; 优化"></a>3. 前端代码瘦身 &amp; 优化</h1><p><strong>鸽</strong></p>
<h1 id="4-后端代码优化"><a href="#4-后端代码优化" class="headerlink" title="4. 后端代码优化"></a>4. 后端代码优化</h1><p><strong>鸽</strong></p>
</div></section><div id="reward-container"><span class="hty-icon-button button-glow" id="reward-button" title="打赏" onclick="var qr = document.getElementById(&quot;qr&quot;); qr.style.display = (qr.style.display === &quot;none&quot;) ? &quot;block&quot; : &quot;none&quot;;"><span class="icon iconify" data-icon="ri:hand-coin-line"></span></span><div id="reward-comment">I'm so cute. Please give me money.</div><div id="qr" style="display:none;"><div style="display:inline-block"><a href="/images/alipay.jpg"><img loading="lazy" src="/images/alipay.jpg" alt="支付宝" title="支付宝"></a><div><span style="color:#00A3EE"><span class="icon iconify" data-icon="ri:alipay-line"></span></span></div></div><div style="display:inline-block"><a href="/images/wechatpay.jpg"><img loading="lazy" src="/images/wechatpay.jpg" alt="微信支付" title="微信支付"></a><div><span style="color:#2DC100"><span class="icon iconify" data-icon="ri:wechat-pay-line"></span></span></div></div></div></div><ul class="post-copyright"><li class="post-copyright-author"><strong>本文作者：</strong>丸了鸭</li><li class="post-copyright-link"><strong>本文链接：</strong><a href="https://cyh245689173.github.io/2022/04/18/%E7%94%A8%E6%88%B7%E4%B8%AD%E5%BF%83%E9%A1%B9%E7%9B%AE%E7%BB%88%E7%AC%94%E8%AE%B0/" title="用户中心项目终笔记">https://cyh245689173.github.io/2022/04/18/%E7%94%A8%E6%88%B7%E4%B8%AD%E5%BF%83%E9%A1%B9%E7%9B%AE%E7%BB%88%E7%AC%94%E8%AE%B0/</a></li><li class="post-copyright-license"><strong>版权声明：</strong>本博客所有文章除特别声明外，均默认采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh" target="_blank" rel="noopener" title="CC BY-NC-SA 4.0 "><span class="icon iconify" data-icon="ri:creative-commons-line"></span><span class="icon iconify" data-icon="ri:creative-commons-by-line"></span><span class="icon iconify" data-icon="ri:creative-commons-nc-line"></span><span class="icon iconify" data-icon="ri:creative-commons-sa-line"></span></a> 许可协议。</li></ul></article><div class="post-nav"><div class="post-nav-item"><a class="post-nav-prev" href="/2022/04/25/%E7%94%A8%E6%88%B7%E4%B8%AD%E5%BF%83%E9%A1%B9%E7%9B%AE%E6%9C%AB%E7%AC%94%E8%AE%B0/" rel="prev" title="用户中心项目末笔记"><span class="icon iconify" data-icon="ri:arrow-left-s-line"></span><span class="post-nav-text">用户中心项目末笔记</span></a></div><div class="post-nav-item"><a class="post-nav-next" href="/2022/04/13/Leecode-75-%E9%A2%9C%E8%89%B2%E5%88%86%E7%B1%BB/" rel="next" title="Leecode 75 颜色分类"><span class="post-nav-text">Leecode 75 颜色分类</span><span class="icon iconify" data-icon="ri:arrow-right-s-line"></span></a></div></div></div><div class="hty-card" id="comment"><div class="comment-tooltip text-center"><span>要不要和我说些什么？</span><br></div><div id="valine-container"></div><script type="module">import { getScript } from '/js/utils.js'
getScript("https://fastly.jsdelivr.net/npm/valine@latest/dist/Valine.min.js", () => {
  const valineConfig = {"enable":true,"appId":"KE7GLrwmrIL3DMv4Lvy7NDwb-gzGzoHsz","appKey":"Ie0kEhvYU883vW9Mw4re3Vlg","placeholder":"期待您给我提出的改进","avatar":null,"pageSize":10,"visitor":true,"highlight":true,"recordIP":false,"enableQQ":true,"el":"#valine-container","lang":"zh-cn"}
  valineConfig.path = "/2022/04/18/%E7%94%A8%E6%88%B7%E4%B8%AD%E5%BF%83%E9%A1%B9%E7%9B%AE%E7%BB%88%E7%AC%94%E8%AE%B0/"
  new Valine(valineConfig)
}, window.Valine);</script></div></main><footer class="sidebar-translate" id="footer"><div class="copyright"><span>&copy; 2020 – 2022 </span><span class="with-love" id="animate"><span class="icon iconify" data-icon="ri:cloud-line"></span></span><span class="author"> 丸了鸭</span></div><div class="live-time"><span>本博客已萌萌哒地运行</span><span id="display_live_time"></span><span class="moe-text">(*╹▽╹*)</span><script>function blog_live_time() {
  setTimeout(blog_live_time, 1000);
  const start = new Date('2021-01-03T00:00:00');
  const now = new Date();
  const timeDiff = (now.getTime() - start.getTime());
  const msPerMinute = 60 * 1000;
  const msPerHour = 60 * msPerMinute;
  const msPerDay = 24 * msPerHour;
  const passDay = Math.floor(timeDiff / msPerDay);
  const passHour = Math.floor((timeDiff % msPerDay) / 60 / 60 / 1000);
  const passMinute = Math.floor((timeDiff % msPerHour) / 60 / 1000);
  const passSecond = Math.floor((timeDiff % msPerMinute) / 1000);
  display_live_time.innerHTML = ` ${passDay} 天 ${passHour} 小时 ${passMinute} 分 ${passSecond} 秒`;
}
blog_live_time();
</script></div></footer></div><a class="hty-icon-button" id="back-to-top" aria-label="back-to-top" href="#"><span class="icon iconify" data-icon="ri:arrow-up-s-line"></span><svg class="progress-circle-container" viewBox="0 0 100 100"><circle class="progress-circle" id="progressCircle" cx="50" cy="50" r="48" fill="none" stroke="#0078E7" stroke-width="2" stroke-linecap="round"></circle></svg></a><a class="popup-trigger hty-icon-button icon-search" id="search" href="javascript:;" title="搜索"><span class="site-state-item-icon"><span class="icon iconify" data-icon="ri:search-line"></span></span></a><script>window.addEventListener("DOMContentLoaded", () => {
  // Handle and trigger popup window
  document.querySelector(".popup-trigger").addEventListener("click", () => {
    document.querySelector(".popup").classList.add("show");
    setTimeout(() => {
      document.querySelector(".search-input").focus();
    }, 100);
  });

  // Monitor main search box
  const onPopupClose = () => {
    document.querySelector(".popup").classList.remove("show");
  };

  document.querySelector(".popup-btn-close").addEventListener("click", () => {
    onPopupClose();
  });

  window.addEventListener("keyup", event => {
    if (event.key === "Escape") {
      onPopupClose();
    }
  });
});
</script><script src="https://fastly.jsdelivr.net/npm/hexo-generator-searchdb@1.4.0/dist/search.js"></script><script src="/js/search/local-search.js" defer type="module"></script><div class="popup search-popup"><div class="search-header"><span class="popup-btn-close close-icon hty-icon-button"><span class="icon iconify" data-icon="ri:close-line"></span></span></div><div class="search-input-container"><input class="search-input" id="local-search-input" type="text" placeholder="想要搜些什么？" value=""></div><div class="search-result-container"></div></div><script src="https://fastly.jsdelivr.net/npm/medium-zoom@1.0.6/dist/medium-zoom.min.js"></script><script>const images = [...document.querySelectorAll('.markdown-body img')]
mediumZoom(images)</script><style>.medium-zoom-image {
  z-index: 99;
}</style></body></html>